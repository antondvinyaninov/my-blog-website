---
import BaseLayout from '../layouts/BaseLayout.astro';
import HeroOverlay from '../components/HeroOverlay.astro';
import LatestArticlesSection from '../components/LatestArticlesSection.astro';
import VideoCard from '../components/VideoCard.astro';
import SectionHeader from '../components/SectionHeader.astro';
import Newsletter from '../components/Newsletter.astro';
import { getPosts } from '../utils/posts-manager';

// Data queries
const POSTS = getPosts();
const heroPosts = POSTS.slice(0, 5); // 1 main + 4 magazine (1 main + 3 side)
const latestPosts = POSTS.slice(1, 5); // 4 posts for latest articles section
const videoPosts = POSTS.filter(p => p.type === 'video').slice(0, 3);
---

<BaseLayout title="Ncmaz | Будущее медиа">
  
  <div class="py-8 lg:py-12">
    {/* Hero Overlay Section */}
    <HeroOverlay post={heroPosts[0]} />

    <section class="container mx-auto px-4 lg:px-8 mb-16 lg:mb-24">
      <LatestArticlesSection posts={latestPosts} title="Последние статьи" viewAllHref="/blog" />
    </section>

    {/* Videos / Podcasts */}
    <section class="container mx-auto px-4 lg:px-8 mb-16 lg:mb-24">
      <SectionHeader title="Видео и подкасты" href="/videos" />
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {videoPosts.map(post => (
          <VideoCard post={post} />
        ))}
      </div>
    </section>
  </div>

  {/* Newsletter */}
  <Newsletter />

</BaseLayout>

<style is:global>
  /* Custom tweaks if needed, usually Tailwind handles it */
  .aspect-video {
    aspect-ratio: 16 / 9;
  }
</style>
