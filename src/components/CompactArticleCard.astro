---
import type { Post } from '../consts';
import CategoryBadge from './CategoryBadge.astro';
import { Heart, MessageCircle, Clock, Bookmark } from 'lucide-react';

interface Props {
  post: Post;
  className?: string;
}

const { 
  post, 
  className = '' 
} = Astro.props;

// Fallback values for missing data
const {
  coverImage = '/images/placeholder.png',
  excerpt = '',
  author = { name: 'Anonymous', avatar: '/images/default-avatar.png' },
  readTime = '0 min read',
  category = { id: 'general', name: 'General', color: 'bg-gray-100 text-gray-800' },
  likes = 0,
  comments = 0
} = post;
---

<article class={`group flex flex-col sm:flex-row gap-4 border border-slate-200 rounded-3xl p-4 transition-all duration-300 hover:shadow-lg ${className}`}>
  <!-- Content Area (Left) -->
  <div class="flex-1 flex flex-col">
    <!-- Category Badge -->
    <div class="mb-2">
      <CategoryBadge 
        name={category.name} 
        color={category.color}
        href={`/blog?category=${category.id}`}
        className="text-xs"
      />
    </div>

    <!-- Title -->
    <h3 class="text-base sm:text-lg font-semibold text-slate-900 leading-snug line-clamp-2 transition-colors duration-300 group-hover:text-blue-600 mb-2">
      <a href={`/blog/${post.slug}`} class="cursor-pointer">
        {post.title}
      </a>
    </h3>

    <!-- Excerpt -->
    <p class="text-xs sm:text-sm text-slate-500 line-clamp-2 mb-2">
      {excerpt}
    </p>

    <!-- Footer (Likes, Comments, Date, Read Time & Bookmark) -->
    <div class="flex items-center justify-between pt-1.5 border-t border-slate-100 mt-auto">
      <div class="flex items-center gap-2">
        <!-- Likes -->
        <button 
          class="flex items-center gap-1 px-2.5 py-1.5 rounded-full bg-rose-50 text-rose-600 transition-colors duration-300 hover:bg-rose-100 cursor-pointer"
          aria-label="Like article"
        >
          <Heart className="w-4 h-4 fill-current" />
          <span class="text-xs font-medium">{likes.toLocaleString()}</span>
        </button>
        
        <!-- Comments -->
        <button 
          class="flex items-center gap-1 px-2.5 py-1.5 rounded-full bg-slate-50 text-slate-600 transition-colors duration-300 hover:bg-teal-50 hover:text-teal-600 cursor-pointer"
          aria-label="View comments"
        >
          <MessageCircle className="w-4 h-4" />
          <span class="text-xs font-medium">{comments}</span>
        </button>
      </div>
      
      <div class="flex items-center gap-2 text-xs text-slate-500">
        <!-- Date -->
        <time>{post.date}</time>
        <span class="w-1 h-1 rounded-full bg-slate-300"></span>
        
        <!-- Read Time -->
        <span>{readTime}</span>
        
        <button 
          class="p-2 rounded-full transition-colors duration-300 hover:bg-slate-100 cursor-pointer"
          aria-label="Bookmark article"
        >
          <Bookmark className="w-4 h-4 text-slate-600" />
        </button>
      </div>
    </div>
  </div>

  <!-- Image Area (Right) -->
  <a 
    href={`/blog/${post.slug}`} 
    class="flex-shrink-0 w-full sm:w-32 sm:h-32 md:w-36 md:h-36 lg:w-40 lg:h-40 h-48 rounded-2xl overflow-hidden bg-slate-100 cursor-pointer"
  >
    <img 
      src={coverImage} 
      alt={post.title} 
      class="w-full h-full object-cover transition-all duration-500 group-hover:brightness-90"
      loading="lazy"
      decoding="async"
      width="320"
      height="320"
    />
  </a>
</article>
